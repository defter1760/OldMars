<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
<link href="https://macyslawsuit.com/wp-content/themes/MacysV3/css/confirmations.css" rel="stylesheet" type="text/css" />


<!--<style>

body {
                font-family: 'Open Sans', sans-serif;
                color:#424242;
                background:#fff;
                margin:0;
                text-align:center;
                height:100%;
}



body, div, h1, h2, h3, h4, h5, h6, p, ul, img {
                margin:0px;
                padding:0px;
}

#main{
                width:100%;
                height:100%;
                text-align:left;
}
#message{
                width:100%;
                margin:0 auto;
                padding-top:20px;
}

.underline{
                text-decoration:underline;
                padding-right:3px;
}

#message h3{
                font-weight:24px;
                line-height:28px;
                text-align:center;
                padding-bottom:30px;
                color:#a31c30;
}

#message h4{
                font-size:18px;
                line-height:22px;
                text-decoration:underline;
                color:#424242;
                text-align:center;
                font-weight:normal;
                padding-bottom:25px;
}

#message p{
                font-size:18px;
                line-height:28px;
                padding-bottom:20px;
                width:100%;
                margin:0 auto;
}

#message ul{
                width:90%;
                margin:0 auto;
                list-style-position:outside;

}

#message ul li{
                font-size:18px;
                line-height:24px;
                padding-bottom:30px;
                list-style:none;
                background:url(https://macyslawsuit.com/wp-content/uploads/2012/04/check.png) no-repeat 0 7px;
                padding-left:40px;
                
}

#message ul li p{
                width:100%;
                padding:0;
}

#message ol{
                width:80%;
                margin:0 auto;
}

#message ol li{
                font-size:18px;
                line-height:24px;
                padding-bottom:;
                color:#a31c30;
                font-weight:bold;
                padding-left:5px;
                padding-bottom:20px;

}

#message ol li p{
                width:100%;
                padding:0;
                margin:0;
                color:#424242;
                font-weight:normal;
}


#message a{
                color:#a31c30;
                font-size:20px;
                text-decoration:none;
                font-weight:bold;
}

#message p.disclaimer{
                font-size:15px;
                                line-height:19px;
                font-style:italic;
                font-family:Times New Roman, Times, serif;
                font-weight:bold;
                text-align:center;
                padding-top:25px;
                
}

.link{
                display:inline-block;
                background: url(https://macyslawsuit.com/wp-content/uploads/2012/04/link1.png) no-repeat 53px 0;
                width:92px;
                height:31px;
                padding-left:3px;
}

</style>-->
<!--<style>

body {
	font-family: 'Open Sans', sans-serif;
	color:#424242;
	background:#fff;
	margin:0;
	text-align:center;
	height:100%;
}



body, div, h1, h2, h3, h4, h5, h6, p, ul, img {
	margin:0px;
	padding:0px;
}

#main{
	width:100%;
	height:100%;
	text-align:left;
}
#message{
	width:100%;
	margin:0 auto;
	padding-top:20px;
}

.underline{
	text-decoration:underline;
	padding-right:3px;
}

#message h3{
	font-weight:24px;
	line-height:28px;
	text-align:center;
	padding-bottom:30px;
	color:#a31c30;
}

#message h4{
	font-size:18px;
	line-height:22px;
	text-decoration:underline;
	color:#424242;
	text-align:center;
	font-weight:normal;
	padding-bottom:25px;
}

#message p{
	font-size:18px;
	line-height:28px;
	padding-bottom:20px;
	width:100%;
	margin:0 auto;
}

#message ul{
	width:90%;
	margin:0 auto;
	list-style-position:outside;

}

#message ul li{
	font-size:18px;
	line-height:24px;
	padding-bottom:30px;
	list-style:none;
	background:url(https://macyslawsuit.com/wp-content/uploads/2012/04/check.png) no-repeat 0 7px;
	padding-left:40px;
	
}

#message ul li p{
	width:100%;
	padding:0;
}

#message ol{
	width:80%;
	margin:0 auto;
}

#message ol li{
	font-size:18px;
	line-height:24px;
	padding-bottom:;
	color:#a31c30;
	font-weight:bold;
	padding-left:5px;
	padding-bottom:20px;

}

#message ol li p{
	width:100%;
	padding:0;
	margin:0;
	color:#424242;
	font-weight:normal;
}


#message a{
	color:#a31c30;
	font-size:20px;
	text-decoration:none;
	font-weight:bold;
}

#message p.disclaimer{
	font-size:15px;
		line-height:19px;
	font-style:italic;
	font-family:Times New Roman, Times, serif;
	font-weight:bold;
	text-align:center;
	padding-top:25px;
	
}

.link{
	display:inline-block;
	background: url(https://macyslawsuit.com/wp-content/uploads/2012/04/link1.png) no-repeat 53px 0;
	width:92px;
	height:31px;
	padding-left:3px;
}
div#main {

  width: 1100px;

  margin-left: auto;

  margin-right: auto;

  text-align: left;

}
</style>

   
    </head>
<body>
<head>
-->


</head>
<!--<style>

body {
	font-family: 'Open Sans', sans-serif;
	color:#424242;
	background:#fff;
	margin:0;
	text-align:center;
	height:100%;
}



body, div, h1, h2, h3, h4, h5, h6, p, ul, img {
	margin:0px;
	padding:0px;
}

#main{
	width:100%;
	height:100%;
	text-align:left;
	
}
#message{
	width:100%;
	margin:0 auto;
	padding-top:20px;
}

#message h3{
	font-weight:24px;
	line-height:28px;
	text-align:center;
	padding-bottom:30px;
	color:#a31c30;
}

#message h4{
	font-size:18px;
	line-height:22px;
	text-decoration:underline;
	color:#424242;
	text-align:center;
	font-weight:normal;
	padding-bottom:25px;
}

#message p{
	font-size:18px;
	line-height:28px;
	padding-bottom:20px;
	width:100%;
	margin:0 auto;
}

#message ul{
	width:90%;
	margin:0 auto;
	list-style-position:outside;

}

#message ul li{
	font-size:18px;
	line-height:24px;
	padding-bottom:30px;
	list-style:none;
	background:url(https://macyslawsuit.com/wp-content/uploads/2012/04/check.png) no-repeat 0 7px;
	padding-left:40px;
	
}


#message a{
	color:#a31c30;
	font-size:20px;
	text-decoration:none;
	font-weight:bold;
}

#message p.disclaimer{
	font-size:15px;
	line-height:19px;
	font-style:italic;
	font-family:Times New Roman, Times, serif;
	font-weight:bold;
	text-align:center;
	padding-top:25px;
	
}

.link{
	display:inline-block;
	background: url(https://macyslawsuit.com/wp-content/uploads/2012/04/link1.png) no-repeat 53px 0;
	width:92px;
	height:31px;
	padding-left:3px;
}
/*div#main {

  width: 850px;

  margin-left: auto;

  margin-right: auto;

  text-align: left;

}*/

img, img a, a img, a {
   outline: none !important;
}
</style>-->
<?PHP
$date = date('Y').'-'.date('m').'-'.date('d');
$time = date('H').':'.date('i').':'.date('s');
$month = date('Y').'-'.date('m');
$week = date('Y').'-'.date('W');

if (empty($TwoSigners)) $TwoSigners = 'Create an Envelope with 2 Signers';
if (empty($RecipientEmail2)) $RecipientEmail2 = 'ihutchings@initiativelegal.com';
if (empty($RecipientName2)) $RecipientName2 = 'Ian Hutchings';
if (isset($_REQUEST['tenantid'])) $tenantid = $_REQUEST['tenantid'];
if (empty($tenantid)) $tenantid = '4';

if (isset($_REQUEST['brandid'])) $brandid = $_REQUEST['brandid'];
if (isset($_REQUEST['uniqueid'])) $uniqueid = $_REQUEST['uniqueid'];
if (isset($_REQUEST['brand'])) $brand = $_REQUEST['brand'];


?>

<?PHP 
$serverName = "localhost\SPICE";

$connectionInfo = array( "Database"=>"SpiceData", "UID"=>"SpiceWriter2012", "PWD"=>"p1c3righttwoohonetwo");
$conn = sqlsrv_connect( $serverName, $connectionInfo );
$query = "SELECT authformreceived,retainerRecieved,feewaiverreceived,completedlongformonline,FirstName,LastName,brand,email,brandid,longformcompleteonline FROM Status WHERE uniqueid='$uniqueid' AND tenantid='$tenantid'";
$results = sqlsrv_query($conn,$query);

	while($row = sqlsrv_fetch_array($results)){


		$authformreceived = $row['authformreceived']; if (empty($authformreceived)) unset($authformreceived);
		$retainerRecieved = $row['retainerRecieved']; if (empty($retainerRecieved)) unset($retainerRecieved);
		$feewaiverreceived = $row['feewaiverreceived']; if (empty($feewaiverreceived)) unset($feewaiverreceived);
		$completedlongformonline = $row['completedlongformonline']; if (empty($completedlongformonline)) unset($completedlongformonline);
		$FirstName = $row['FirstName']; if (empty($FirstName)) unset($FirstName);
		$LastName = $row['LastName']; if (empty($LastName)) unset($LastName);
		$brandname = $row['brand']; if (empty($brandname)) unset($brandname);
		$email = $row['email']; if (empty($email)) unset($email);
		$brandid = $row['brandid']; if (empty($brandid)) unset($brandid);
		$brand = $row['brand']; if (empty($brand)) unset($brand);
		$longformcompleteonline = $row['longformcompleteonline']; if (empty($longformcompleteonline)) unset($longformcompleteonline);

  }
  		$query = "IF EXISTS (SELECT uniqueid from status WHERE uniqueid='$uniqueid' AND tenantid='$tenantid') UPDATE status set authformsent='Docusign',authformsentdate='$date',authformsentmonth='$month',authformsentweek='$week' WHERE uniqueid='$uniqueid' AND tenantid='$tenantid'";
		$results = sqlsrv_query($conn,$query);
?>


<!--<div id="main">-->
<?PHP
$link = "getauth.php";
if (isset($authformreceived)) if ($authformreceived == 'Yes')
{
	$link = "macysdetailedquestionnaire.php";
	#echo "It looks like you've already signed the authorization form, give us a call if you have any questions.";
}
if (isset($completedlongformonline)) if ($completedlongformonline == 'Yes')
{
	$link = "feewaiverprequal.php";
	#echo "It looks like you've already completed our detailed questionnaire, give us a call if you have any questions.";
}
if (isset($feewaiverreceived)) if ($feewaiverreceived == 'Yes')
{
	$link = "";
	#echo "It looks like you've already signed the authorization form, give us a call if you have any questions.";
}
if (isset($feewaiverreceived)) if ($feewaiverreceived == 'Not Qualified')
{
	$link = "";
	#echo "It looks like you've already completed the fee waiver, give us a call if you have any questions.";
}
?>

<?PHP
if (!isset($authformreceived))
{//wrap this in conditional -- only if never signed auth before will they see this

//PDF CREATOR
define('FPDF_FONTPATH', 'font/');
require('fpdf.php');
$date = date('Y').'-'.date('m').'-'.date('d');
$thedateis =  date('l').' '.date('F').' '.date('j').''.date('S').', '.date('Y');

class PDF_Code128 extends FPDF {

var $T128;                                             // tableau des codes 128
var $ABCset="";                                        // jeu des caractères éligibles au C128
var $Aset="";                                          // Set A du jeu des caractères éligibles
var $Bset="";                                          // Set B du jeu des caractères éligibles
var $Cset="";                                          // Set C du jeu des caractères éligibles
var $SetFrom;                                          // Convertisseur source des jeux vers le tableau
var $SetTo;                                            // Convertisseur destination des jeux vers le tableau
var $JStart = array("A"=>103, "B"=>104, "C"=>105);     // Caractères de sélection de jeu au début du C128
var $JSwap = array("A"=>101, "B"=>100, "C"=>99);       // Caractères de changement de jeu

//____________________________ Extension du constructeur _______________________
function PDF_Code128($orientation='P', $unit='mm', $format='A4') {

    parent::FPDF($orientation,$unit,$format);

    $this->T128[] = array(2, 1, 2, 2, 2, 2);           //0 : [ ]               // composition des caractères
    $this->T128[] = array(2, 2, 2, 1, 2, 2);           //1 : [!]
    $this->T128[] = array(2, 2, 2, 2, 2, 1);           //2 : ["]
    $this->T128[] = array(1, 2, 1, 2, 2, 3);           //3 : [#]
    $this->T128[] = array(1, 2, 1, 3, 2, 2);           //4 : [$]
    $this->T128[] = array(1, 3, 1, 2, 2, 2);           //5 : [%]
    $this->T128[] = array(1, 2, 2, 2, 1, 3);           //6 : [&]
    $this->T128[] = array(1, 2, 2, 3, 1, 2);           //7 : [']
    $this->T128[] = array(1, 3, 2, 2, 1, 2);           //8 : [(]
    $this->T128[] = array(2, 2, 1, 2, 1, 3);           //9 : [)]
    $this->T128[] = array(2, 2, 1, 3, 1, 2);           //10 : [*]
    $this->T128[] = array(2, 3, 1, 2, 1, 2);           //11 : [+]
    $this->T128[] = array(1, 1, 2, 2, 3, 2);           //12 : [,]
    $this->T128[] = array(1, 2, 2, 1, 3, 2);           //13 : [-]
    $this->T128[] = array(1, 2, 2, 2, 3, 1);           //14 : [.]
    $this->T128[] = array(1, 1, 3, 2, 2, 2);           //15 : [/]
    $this->T128[] = array(1, 2, 3, 1, 2, 2);           //16 : [0]
    $this->T128[] = array(1, 2, 3, 2, 2, 1);           //17 : [1]
    $this->T128[] = array(2, 2, 3, 2, 1, 1);           //18 : [2]
    $this->T128[] = array(2, 2, 1, 1, 3, 2);           //19 : [3]
    $this->T128[] = array(2, 2, 1, 2, 3, 1);           //20 : [4]
    $this->T128[] = array(2, 1, 3, 2, 1, 2);           //21 : [5]
    $this->T128[] = array(2, 2, 3, 1, 1, 2);           //22 : [6]
    $this->T128[] = array(3, 1, 2, 1, 3, 1);           //23 : [7]
    $this->T128[] = array(3, 1, 1, 2, 2, 2);           //24 : [8]
    $this->T128[] = array(3, 2, 1, 1, 2, 2);           //25 : [9]
    $this->T128[] = array(3, 2, 1, 2, 2, 1);           //26 : [:]
    $this->T128[] = array(3, 1, 2, 2, 1, 2);           //27 : [;]
    $this->T128[] = array(3, 2, 2, 1, 1, 2);           //28 : [<]
    $this->T128[] = array(3, 2, 2, 2, 1, 1);           //29 : [=]
    $this->T128[] = array(2, 1, 2, 1, 2, 3);           //30 : [>]
    $this->T128[] = array(2, 1, 2, 3, 2, 1);           //31 : [?]
    $this->T128[] = array(2, 3, 2, 1, 2, 1);           //32 : [@]
    $this->T128[] = array(1, 1, 1, 3, 2, 3);           //33 : [A]
    $this->T128[] = array(1, 3, 1, 1, 2, 3);           //34 : [B]
    $this->T128[] = array(1, 3, 1, 3, 2, 1);           //35 : [C]
    $this->T128[] = array(1, 1, 2, 3, 1, 3);           //36 : [D]
    $this->T128[] = array(1, 3, 2, 1, 1, 3);           //37 : [E]
    $this->T128[] = array(1, 3, 2, 3, 1, 1);           //38 : [F]
    $this->T128[] = array(2, 1, 1, 3, 1, 3);           //39 : [G]
    $this->T128[] = array(2, 3, 1, 1, 1, 3);           //40 : [H]
    $this->T128[] = array(2, 3, 1, 3, 1, 1);           //41 : [I]
    $this->T128[] = array(1, 1, 2, 1, 3, 3);           //42 : [J]
    $this->T128[] = array(1, 1, 2, 3, 3, 1);           //43 : [K]
    $this->T128[] = array(1, 3, 2, 1, 3, 1);           //44 : [L]
    $this->T128[] = array(1, 1, 3, 1, 2, 3);           //45 : [M]
    $this->T128[] = array(1, 1, 3, 3, 2, 1);           //46 : [N]
    $this->T128[] = array(1, 3, 3, 1, 2, 1);           //47 : [O]
    $this->T128[] = array(3, 1, 3, 1, 2, 1);           //48 : [P]
    $this->T128[] = array(2, 1, 1, 3, 3, 1);           //49 : [Q]
    $this->T128[] = array(2, 3, 1, 1, 3, 1);           //50 : [R]
    $this->T128[] = array(2, 1, 3, 1, 1, 3);           //51 : [S]
    $this->T128[] = array(2, 1, 3, 3, 1, 1);           //52 : [T]
    $this->T128[] = array(2, 1, 3, 1, 3, 1);           //53 : [U]
    $this->T128[] = array(3, 1, 1, 1, 2, 3);           //54 : [V]
    $this->T128[] = array(3, 1, 1, 3, 2, 1);           //55 : [W]
    $this->T128[] = array(3, 3, 1, 1, 2, 1);           //56 : [X]
    $this->T128[] = array(3, 1, 2, 1, 1, 3);           //57 : [Y]
    $this->T128[] = array(3, 1, 2, 3, 1, 1);           //58 : [Z]
    $this->T128[] = array(3, 3, 2, 1, 1, 1);           //59 : [[]
    $this->T128[] = array(3, 1, 4, 1, 1, 1);           //60 : [\]
    $this->T128[] = array(2, 2, 1, 4, 1, 1);           //61 : []]
    $this->T128[] = array(4, 3, 1, 1, 1, 1);           //62 : [^]
    $this->T128[] = array(1, 1, 1, 2, 2, 4);           //63 : [_]
    $this->T128[] = array(1, 1, 1, 4, 2, 2);           //64 : [`]
    $this->T128[] = array(1, 2, 1, 1, 2, 4);           //65 : [a]
    $this->T128[] = array(1, 2, 1, 4, 2, 1);           //66 : [b]
    $this->T128[] = array(1, 4, 1, 1, 2, 2);           //67 : [c]
    $this->T128[] = array(1, 4, 1, 2, 2, 1);           //68 : [d]
    $this->T128[] = array(1, 1, 2, 2, 1, 4);           //69 : [e]
    $this->T128[] = array(1, 1, 2, 4, 1, 2);           //70 : [f]
    $this->T128[] = array(1, 2, 2, 1, 1, 4);           //71 : [g]
    $this->T128[] = array(1, 2, 2, 4, 1, 1);           //72 : [h]
    $this->T128[] = array(1, 4, 2, 1, 1, 2);           //73 : [i]
    $this->T128[] = array(1, 4, 2, 2, 1, 1);           //74 : [j]
    $this->T128[] = array(2, 4, 1, 2, 1, 1);           //75 : [k]
    $this->T128[] = array(2, 2, 1, 1, 1, 4);           //76 : [l]
    $this->T128[] = array(4, 1, 3, 1, 1, 1);           //77 : [m]
    $this->T128[] = array(2, 4, 1, 1, 1, 2);           //78 : [n]
    $this->T128[] = array(1, 3, 4, 1, 1, 1);           //79 : [o]
    $this->T128[] = array(1, 1, 1, 2, 4, 2);           //80 : [p]
    $this->T128[] = array(1, 2, 1, 1, 4, 2);           //81 : [q]
    $this->T128[] = array(1, 2, 1, 2, 4, 1);           //82 : [r]
    $this->T128[] = array(1, 1, 4, 2, 1, 2);           //83 : [s]
    $this->T128[] = array(1, 2, 4, 1, 1, 2);           //84 : [t]
    $this->T128[] = array(1, 2, 4, 2, 1, 1);           //85 : [u]
    $this->T128[] = array(4, 1, 1, 2, 1, 2);           //86 : [v]
    $this->T128[] = array(4, 2, 1, 1, 1, 2);           //87 : [w]
    $this->T128[] = array(4, 2, 1, 2, 1, 1);           //88 : [x]
    $this->T128[] = array(2, 1, 2, 1, 4, 1);           //89 : [y]
    $this->T128[] = array(2, 1, 4, 1, 2, 1);           //90 : [z]
    $this->T128[] = array(4, 1, 2, 1, 2, 1);           //91 : [{]
    $this->T128[] = array(1, 1, 1, 1, 4, 3);           //92 : [|]
    $this->T128[] = array(1, 1, 1, 3, 4, 1);           //93 : [}]
    $this->T128[] = array(1, 3, 1, 1, 4, 1);           //94 : [~]
    $this->T128[] = array(1, 1, 4, 1, 1, 3);           //95 : [DEL]
    $this->T128[] = array(1, 1, 4, 3, 1, 1);           //96 : [FNC3]
    $this->T128[] = array(4, 1, 1, 1, 1, 3);           //97 : [FNC2]
    $this->T128[] = array(4, 1, 1, 3, 1, 1);           //98 : [SHIFT]
    $this->T128[] = array(1, 1, 3, 1, 4, 1);           //99 : [Cswap]
    $this->T128[] = array(1, 1, 4, 1, 3, 1);           //100 : [Bswap]                
    $this->T128[] = array(3, 1, 1, 1, 4, 1);           //101 : [Aswap]
    $this->T128[] = array(4, 1, 1, 1, 3, 1);           //102 : [FNC1]
    $this->T128[] = array(2, 1, 1, 4, 1, 2);           //103 : [Astart]
    $this->T128[] = array(2, 1, 1, 2, 1, 4);           //104 : [Bstart]
    $this->T128[] = array(2, 1, 1, 2, 3, 2);           //105 : [Cstart]
    $this->T128[] = array(2, 3, 3, 1, 1, 1);           //106 : [STOP]
    $this->T128[] = array(2, 1);                       //107 : [END BAR]

    for ($i = 32; $i <= 95; $i++) {                                            // jeux de caractères
        $this->ABCset .= chr($i);
    }
    $this->Aset = $this->ABCset;
    $this->Bset = $this->ABCset;
    for ($i = 0; $i <= 31; $i++) {
        $this->ABCset .= chr($i);
        $this->Aset .= chr($i);
    }
    for ($i = 96; $i <= 126; $i++) {
        $this->ABCset .= chr($i);
        $this->Bset .= chr($i);
    }
    $this->Cset="0123456789";

    for ($i=0; $i<96; $i++) {                                                  // convertisseurs des jeux A & B  
        @$this->SetFrom["A"] .= chr($i);
        @$this->SetFrom["B"] .= chr($i + 32);
        @$this->SetTo["A"] .= chr(($i < 32) ? $i+64 : $i-32);
        @$this->SetTo["B"] .= chr($i);
    }
}

//________________ Fonction encodage et dessin du code 128 _____________________
function Header()
{
	global $title;
	$this->Ln(5);
}
function Footer()
{
	// Position at 1.5 cm from bottom
	$this->SetY(-25);
	// Arial italic 8
	$this->SetFont('Arial','',9);
	// Text color in gray
	$this->SetTextColor(128);
	// Page number
#	$this->Cell(0,10,'Page '.$this->PageNo(),0,0,'C');
	$this->Cell(0,10,'1800 Century Park East, 2nd Floor  -  Los Angeles, California 90067 ','','','C');
	$this->Ln(3);
	$this->Cell(0,10,'888.792.2293 Main  -  310.734.1665 Fax  -  www.MacysLawsuit.com ','','','C');
	$this->Ln(1);
	#$this->Cell(0,10,'CLIENT INITIALS _______','','','R');
	$this->Ln(9);
}


function Code128($x, $y, $code, $w, $h) {
    $Aguid = "";                                                                      // Création des guides de choix ABC
    $Bguid = "";
    $Cguid = "";
    for ($i=0; $i < strlen($code); $i++) {
        $needle = substr($code,$i,1);
        $Aguid .= ((strpos($this->Aset,$needle)===false) ? "N" : "O"); 
        $Bguid .= ((strpos($this->Bset,$needle)===false) ? "N" : "O"); 
        $Cguid .= ((strpos($this->Cset,$needle)===false) ? "N" : "O");
    }

    $SminiC = "OOOO";
    $IminiC = 4;

    $crypt = "";
    while ($code > "") {
                                                                                    // BOUCLE PRINCIPALE DE CODAGE
        $i = strpos($Cguid,$SminiC);                                                // forçage du jeu C, si possible
        if ($i!==false) {
            $Aguid [$i] = "N";
            $Bguid [$i] = "N";
        }

        if (substr($Cguid,0,$IminiC) == $SminiC) {                                  // jeu C
            $crypt .= chr(($crypt > "") ? $this->JSwap["C"] : $this->JStart["C"]);  // début Cstart, sinon Cswap
            $made = strpos($Cguid,"N");                                             // étendu du set C
            if ($made === false) {
                $made = strlen($Cguid);
            }
            if (fmod($made,2)==1) {
                $made--;                                                            // seulement un nombre pair
            }
            for ($i=0; $i < $made; $i += 2) {
                $crypt .= chr(strval(substr($code,$i,2)));                          // conversion 2 par 2
            }
            $jeu = "C";
        } else {
            $madeA = strpos($Aguid,"N");                                            // étendu du set A
            if ($madeA === false) {
                $madeA = strlen($Aguid);
            }
            $madeB = strpos($Bguid,"N");                                            // étendu du set B
            if ($madeB === false) {
                $madeB = strlen($Bguid);
            }
            $made = (($madeA < $madeB) ? $madeB : $madeA );                         // étendu traitée
            $jeu = (($madeA < $madeB) ? "B" : "A" );                                // Jeu en cours

            $crypt .= chr(($crypt > "") ? $this->JSwap[$jeu] : $this->JStart[$jeu]); // début start, sinon swap

            $crypt .= strtr(substr($code, 0,$made), $this->SetFrom[$jeu], $this->SetTo[$jeu]); // conversion selon jeu

        }
        $code = substr($code,$made);                                           // raccourcir légende et guides de la zone traitée
        $Aguid = substr($Aguid,$made);
        $Bguid = substr($Bguid,$made);
        $Cguid = substr($Cguid,$made);
    }                                                                          // FIN BOUCLE PRINCIPALE

    $check = ord($crypt[0]);                                                   // calcul de la somme de contrôle
    for ($i=0; $i<strlen($crypt); $i++) {
        $check += (ord($crypt[$i]) * $i);
    }
    $check %= 103;

    $crypt .= chr($check) . chr(106) . chr(107);                               // Chaine Cryptée complète

    $i = (strlen($crypt) * 11) - 8;                                            // calcul de la largeur du module
    $modul = $w/$i;

    for ($i=0; $i<strlen($crypt); $i++) {                                      // BOUCLE D'IMPRESSION
        $c = $this->T128[ord($crypt[$i])];
        for ($j=0; $j<count($c); $j++) {
            $this->Rect($x,$y,$c[$j]*$modul,$h,"F");
            $x += ($c[$j++]+$c[$j])*$modul;
        }
    }
}
}                                                                              // FIN DE CLASSE

$pdf = new PDF_Code128();

//define('FPDF_FONTPATH', 'font/');
//require('fpdf.php');
//$date = date('Y').'-'.date('m').'-'.date('d');
//$thedateis =  date('l').' '.date('F').' '.date('j').''.date('S').', '.date('Y');
//
//class PDF_Code128 extends FPDF {
//
//var $T128;                                             // tableau des codes 128
//var $ABCset="";                                        // jeu des caractères éligibles au C128
//var $Aset="";                                          // Set A du jeu des caractères éligibles
//var $Bset="";                                          // Set B du jeu des caractères éligibles
//var $Cset="";                                          // Set C du jeu des caractères éligibles
//var $SetFrom;                                          // Convertisseur source des jeux vers le tableau
//var $SetTo;                                            // Convertisseur destination des jeux vers le tableau
//var $JStart = array("A"=>103, "B"=>104, "C"=>105);     // Caractères de sélection de jeu au début du C128
//var $JSwap = array("A"=>101, "B"=>100, "C"=>99);       // Caractères de changement de jeu
//
////____________________________ Extension du constructeur _______________________
//function PDF_Code128($orientation='P', $unit='mm', $format='A4') {
//
//    parent::FPDF($orientation,$unit,$format);
//
//    $this->T128[] = array(2, 1, 2, 2, 2, 2);           //0 : [ ]               // composition des caractères
//    $this->T128[] = array(2, 2, 2, 1, 2, 2);           //1 : [!]
//    $this->T128[] = array(2, 2, 2, 2, 2, 1);           //2 : ["]
//    $this->T128[] = array(1, 2, 1, 2, 2, 3);           //3 : [#]
//    $this->T128[] = array(1, 2, 1, 3, 2, 2);           //4 : [$]
//    $this->T128[] = array(1, 3, 1, 2, 2, 2);           //5 : [%]
//    $this->T128[] = array(1, 2, 2, 2, 1, 3);           //6 : [&]
//    $this->T128[] = array(1, 2, 2, 3, 1, 2);           //7 : [']
//    $this->T128[] = array(1, 3, 2, 2, 1, 2);           //8 : [(]
//    $this->T128[] = array(2, 2, 1, 2, 1, 3);           //9 : [)]
//    $this->T128[] = array(2, 2, 1, 3, 1, 2);           //10 : [*]
//    $this->T128[] = array(2, 3, 1, 2, 1, 2);           //11 : [+]
//    $this->T128[] = array(1, 1, 2, 2, 3, 2);           //12 : [,]
//    $this->T128[] = array(1, 2, 2, 1, 3, 2);           //13 : [-]
//    $this->T128[] = array(1, 2, 2, 2, 3, 1);           //14 : [.]
//    $this->T128[] = array(1, 1, 3, 2, 2, 2);           //15 : [/]
//    $this->T128[] = array(1, 2, 3, 1, 2, 2);           //16 : [0]
//    $this->T128[] = array(1, 2, 3, 2, 2, 1);           //17 : [1]
//    $this->T128[] = array(2, 2, 3, 2, 1, 1);           //18 : [2]
//    $this->T128[] = array(2, 2, 1, 1, 3, 2);           //19 : [3]
//    $this->T128[] = array(2, 2, 1, 2, 3, 1);           //20 : [4]
//    $this->T128[] = array(2, 1, 3, 2, 1, 2);           //21 : [5]
//    $this->T128[] = array(2, 2, 3, 1, 1, 2);           //22 : [6]
//    $this->T128[] = array(3, 1, 2, 1, 3, 1);           //23 : [7]
//    $this->T128[] = array(3, 1, 1, 2, 2, 2);           //24 : [8]
//    $this->T128[] = array(3, 2, 1, 1, 2, 2);           //25 : [9]
//    $this->T128[] = array(3, 2, 1, 2, 2, 1);           //26 : [:]
//    $this->T128[] = array(3, 1, 2, 2, 1, 2);           //27 : [;]
//    $this->T128[] = array(3, 2, 2, 1, 1, 2);           //28 : [<]
//    $this->T128[] = array(3, 2, 2, 2, 1, 1);           //29 : [=]
//    $this->T128[] = array(2, 1, 2, 1, 2, 3);           //30 : [>]
//    $this->T128[] = array(2, 1, 2, 3, 2, 1);           //31 : [?]
//    $this->T128[] = array(2, 3, 2, 1, 2, 1);           //32 : [@]
//    $this->T128[] = array(1, 1, 1, 3, 2, 3);           //33 : [A]
//    $this->T128[] = array(1, 3, 1, 1, 2, 3);           //34 : [B]
//    $this->T128[] = array(1, 3, 1, 3, 2, 1);           //35 : [C]
//    $this->T128[] = array(1, 1, 2, 3, 1, 3);           //36 : [D]
//    $this->T128[] = array(1, 3, 2, 1, 1, 3);           //37 : [E]
//    $this->T128[] = array(1, 3, 2, 3, 1, 1);           //38 : [F]
//    $this->T128[] = array(2, 1, 1, 3, 1, 3);           //39 : [G]
//    $this->T128[] = array(2, 3, 1, 1, 1, 3);           //40 : [H]
//    $this->T128[] = array(2, 3, 1, 3, 1, 1);           //41 : [I]
//    $this->T128[] = array(1, 1, 2, 1, 3, 3);           //42 : [J]
//    $this->T128[] = array(1, 1, 2, 3, 3, 1);           //43 : [K]
//    $this->T128[] = array(1, 3, 2, 1, 3, 1);           //44 : [L]
//    $this->T128[] = array(1, 1, 3, 1, 2, 3);           //45 : [M]
//    $this->T128[] = array(1, 1, 3, 3, 2, 1);           //46 : [N]
//    $this->T128[] = array(1, 3, 3, 1, 2, 1);           //47 : [O]
//    $this->T128[] = array(3, 1, 3, 1, 2, 1);           //48 : [P]
//    $this->T128[] = array(2, 1, 1, 3, 3, 1);           //49 : [Q]
//    $this->T128[] = array(2, 3, 1, 1, 3, 1);           //50 : [R]
//    $this->T128[] = array(2, 1, 3, 1, 1, 3);           //51 : [S]
//    $this->T128[] = array(2, 1, 3, 3, 1, 1);           //52 : [T]
//    $this->T128[] = array(2, 1, 3, 1, 3, 1);           //53 : [U]
//    $this->T128[] = array(3, 1, 1, 1, 2, 3);           //54 : [V]
//    $this->T128[] = array(3, 1, 1, 3, 2, 1);           //55 : [W]
//    $this->T128[] = array(3, 3, 1, 1, 2, 1);           //56 : [X]
//    $this->T128[] = array(3, 1, 2, 1, 1, 3);           //57 : [Y]
//    $this->T128[] = array(3, 1, 2, 3, 1, 1);           //58 : [Z]
//    $this->T128[] = array(3, 3, 2, 1, 1, 1);           //59 : [[]
//    $this->T128[] = array(3, 1, 4, 1, 1, 1);           //60 : [\]
//    $this->T128[] = array(2, 2, 1, 4, 1, 1);           //61 : []]
//    $this->T128[] = array(4, 3, 1, 1, 1, 1);           //62 : [^]
//    $this->T128[] = array(1, 1, 1, 2, 2, 4);           //63 : [_]
//    $this->T128[] = array(1, 1, 1, 4, 2, 2);           //64 : [`]
//    $this->T128[] = array(1, 2, 1, 1, 2, 4);           //65 : [a]
//    $this->T128[] = array(1, 2, 1, 4, 2, 1);           //66 : [b]
//    $this->T128[] = array(1, 4, 1, 1, 2, 2);           //67 : [c]
//    $this->T128[] = array(1, 4, 1, 2, 2, 1);           //68 : [d]
//    $this->T128[] = array(1, 1, 2, 2, 1, 4);           //69 : [e]
//    $this->T128[] = array(1, 1, 2, 4, 1, 2);           //70 : [f]
//    $this->T128[] = array(1, 2, 2, 1, 1, 4);           //71 : [g]
//    $this->T128[] = array(1, 2, 2, 4, 1, 1);           //72 : [h]
//    $this->T128[] = array(1, 4, 2, 1, 1, 2);           //73 : [i]
//    $this->T128[] = array(1, 4, 2, 2, 1, 1);           //74 : [j]
//    $this->T128[] = array(2, 4, 1, 2, 1, 1);           //75 : [k]
//    $this->T128[] = array(2, 2, 1, 1, 1, 4);           //76 : [l]
//    $this->T128[] = array(4, 1, 3, 1, 1, 1);           //77 : [m]
//    $this->T128[] = array(2, 4, 1, 1, 1, 2);           //78 : [n]
//    $this->T128[] = array(1, 3, 4, 1, 1, 1);           //79 : [o]
//    $this->T128[] = array(1, 1, 1, 2, 4, 2);           //80 : [p]
//    $this->T128[] = array(1, 2, 1, 1, 4, 2);           //81 : [q]
//    $this->T128[] = array(1, 2, 1, 2, 4, 1);           //82 : [r]
//    $this->T128[] = array(1, 1, 4, 2, 1, 2);           //83 : [s]
//    $this->T128[] = array(1, 2, 4, 1, 1, 2);           //84 : [t]
//    $this->T128[] = array(1, 2, 4, 2, 1, 1);           //85 : [u]
//    $this->T128[] = array(4, 1, 1, 2, 1, 2);           //86 : [v]
//    $this->T128[] = array(4, 2, 1, 1, 1, 2);           //87 : [w]
//    $this->T128[] = array(4, 2, 1, 2, 1, 1);           //88 : [x]
//    $this->T128[] = array(2, 1, 2, 1, 4, 1);           //89 : [y]
//    $this->T128[] = array(2, 1, 4, 1, 2, 1);           //90 : [z]
//    $this->T128[] = array(4, 1, 2, 1, 2, 1);           //91 : [{]
//    $this->T128[] = array(1, 1, 1, 1, 4, 3);           //92 : [|]
//    $this->T128[] = array(1, 1, 1, 3, 4, 1);           //93 : [}]
//    $this->T128[] = array(1, 3, 1, 1, 4, 1);           //94 : [~]
//    $this->T128[] = array(1, 1, 4, 1, 1, 3);           //95 : [DEL]
//    $this->T128[] = array(1, 1, 4, 3, 1, 1);           //96 : [FNC3]
//    $this->T128[] = array(4, 1, 1, 1, 1, 3);           //97 : [FNC2]
//    $this->T128[] = array(4, 1, 1, 3, 1, 1);           //98 : [SHIFT]
//    $this->T128[] = array(1, 1, 3, 1, 4, 1);           //99 : [Cswap]
//    $this->T128[] = array(1, 1, 4, 1, 3, 1);           //100 : [Bswap]                
//    $this->T128[] = array(3, 1, 1, 1, 4, 1);           //101 : [Aswap]
//    $this->T128[] = array(4, 1, 1, 1, 3, 1);           //102 : [FNC1]
//    $this->T128[] = array(2, 1, 1, 4, 1, 2);           //103 : [Astart]
//    $this->T128[] = array(2, 1, 1, 2, 1, 4);           //104 : [Bstart]
//    $this->T128[] = array(2, 1, 1, 2, 3, 2);           //105 : [Cstart]
//    $this->T128[] = array(2, 3, 3, 1, 1, 1);           //106 : [STOP]
//    $this->T128[] = array(2, 1);                       //107 : [END BAR]
//
//    for ($i = 32; $i <= 95; $i++) {                                            // jeux de caractères
//        $this->ABCset .= chr($i);
//    }
//    $this->Aset = $this->ABCset;
//    $this->Bset = $this->ABCset;
//    for ($i = 0; $i <= 31; $i++) {
//        $this->ABCset .= chr($i);
//        $this->Aset .= chr($i);
//    }
//    for ($i = 96; $i <= 126; $i++) {
//        $this->ABCset .= chr($i);
//        $this->Bset .= chr($i);
//    }
//    $this->Cset="0123456789";
//
//    for ($i=0; $i<96; $i++) {                                                  // convertisseurs des jeux A & B  
//        @$this->SetFrom["A"] .= chr($i);
//        @$this->SetFrom["B"] .= chr($i + 32);
//        @$this->SetTo["A"] .= chr(($i < 32) ? $i+64 : $i-32);
//        @$this->SetTo["B"] .= chr($i);
//    }
//}
//
////________________ Fonction encodage et dessin du code 128 _____________________
//function Header()
//{
//	global $title;
//	$this->Ln(14);
//}
//function Footer()
//{
//	// Position at 1.5 cm from bottom
//	$this->SetY(-25);
//	// Arial italic 8
//	$this->SetFont('Arial','',9);
//	// Text color in gray
//	$this->SetTextColor(128);
//	// Page number
//#	$this->Cell(0,10,'Page '.$this->PageNo(),0,0,'C');
//	$this->Cell(0,10,'1800 Century Park East, 2nd Floor  -  Los Angeles, California 90067 ','','','C');
//	$this->Ln(3);
//	$this->Cell(0,10,'888.792.2293 Main  -  310.734.1665 Fax  -  www.MacysLawsuit.com ','','','C');
//	$this->Ln(4);
//	#$this->Cell(0,10,'CLIENT INITIALS _______','','','R');
//	$this->Ln(9);
//}
//
//
//function Code128($x, $y, $code, $w, $h) {
//    $Aguid = "";                                                                      // Création des guides de choix ABC
//    $Bguid = "";
//    $Cguid = "";
//    for ($i=0; $i < strlen($code); $i++) {
//        $needle = substr($code,$i,1);
//        $Aguid .= ((strpos($this->Aset,$needle)===false) ? "N" : "O"); 
//        $Bguid .= ((strpos($this->Bset,$needle)===false) ? "N" : "O"); 
//        $Cguid .= ((strpos($this->Cset,$needle)===false) ? "N" : "O");
//    }
//
//    $SminiC = "OOOO";
//    $IminiC = 4;
//
//    $crypt = "";
//    while ($code > "") {
//                                                                                    // BOUCLE PRINCIPALE DE CODAGE
//        $i = strpos($Cguid,$SminiC);                                                // forçage du jeu C, si possible
//        if ($i!==false) {
//            $Aguid [$i] = "N";
//            $Bguid [$i] = "N";
//        }
//
//        if (substr($Cguid,0,$IminiC) == $SminiC) {                                  // jeu C
//            $crypt .= chr(($crypt > "") ? $this->JSwap["C"] : $this->JStart["C"]);  // début Cstart, sinon Cswap
//            $made = strpos($Cguid,"N");                                             // étendu du set C
//            if ($made === false) {
//                $made = strlen($Cguid);
//            }
//            if (fmod($made,2)==1) {
//                $made--;                                                            // seulement un nombre pair
//            }
//            for ($i=0; $i < $made; $i += 2) {
//                $crypt .= chr(strval(substr($code,$i,2)));                          // conversion 2 par 2
//            }
//            $jeu = "C";
//        } else {
//            $madeA = strpos($Aguid,"N");                                            // étendu du set A
//            if ($madeA === false) {
//                $madeA = strlen($Aguid);
//            }
//            $madeB = strpos($Bguid,"N");                                            // étendu du set B
//            if ($madeB === false) {
//                $madeB = strlen($Bguid);
//            }
//            $made = (($madeA < $madeB) ? $madeB : $madeA );                         // étendu traitée
//            $jeu = (($madeA < $madeB) ? "B" : "A" );                                // Jeu en cours
//
//            $crypt .= chr(($crypt > "") ? $this->JSwap[$jeu] : $this->JStart[$jeu]); // début start, sinon swap
//
//            $crypt .= strtr(substr($code, 0,$made), $this->SetFrom[$jeu], $this->SetTo[$jeu]); // conversion selon jeu
//
//        }
//        $code = substr($code,$made);                                           // raccourcir légende et guides de la zone traitée
//        $Aguid = substr($Aguid,$made);
//        $Bguid = substr($Bguid,$made);
//        $Cguid = substr($Cguid,$made);
//    }                                                                          // FIN BOUCLE PRINCIPALE
//
//    $check = ord($crypt[0]);                                                   // calcul de la somme de contrôle
//    for ($i=0; $i<strlen($crypt); $i++) {
//        $check += (ord($crypt[$i]) * $i);
//    }
//    $check %= 103;
//
//    $crypt .= chr($check) . chr(106) . chr(107);                               // Chaine Cryptée complète
//
//    $i = (strlen($crypt) * 11) - 8;                                            // calcul de la largeur du module
//    $modul = $w/$i;
//
//    for ($i=0; $i<strlen($crypt); $i++) {                                      // BOUCLE D'IMPRESSION
//        $c = $this->T128[ord($crypt[$i])];
//        for ($j=0; $j<count($c); $j++) {
//            $this->Rect($x,$y,$c[$j]*$modul,$h,"F");
//            $x += ($c[$j++]+$c[$j])*$modul;
//        }
//    }
//}
//}                                                                              // FIN DE CLASSE
//
//$pdf = new PDF_Code128();

$pdf->AddPage();
$hellocompany = 'INITIATIVE LEGAL GROUP APC';
$pdf->Image('logo.png',62,15,'',8,0,'','');
#$pdf->Image('logo.png',);
#$pdf->Image('logo.png',62,13,8,0,'','');
$pdf->Ln();
#$pdf->SetFont('helvetica','B',12);
#$pdf->MultiCell(0,5,$hellocompany,'','C');
$pdf->Ln(15);

//AUTH FORM START
$clientname = "$FirstName" . " $LastName";
$authtitle = 'AUTHORIZATION FOR RELEASE OF';
$authtitle2 = 'PERSONNEL FILE AND WAGE RECORDS';
$authline = '_________________________________________';
$towhom = 'To Whom It May Concern:';
$authintro = 'I, ' . "$clientname" . ':';
$authtext = 'request that Macy\'s, Inc. and any related entities send copies of the following to my attorneys, Initiative Legal Group APC, located at 1800 Century Park East, 2nd Floor, Los Angeles, California 90067 as soon as practicable, but no later than 21 calendar days after the date this request has been submitted:';
$authtext2 = '          a) My entire employee personnel file, including any documents I signed; and';
$authtext3 = '          b) All of my time, wage and payroll records, including my wage stubs in their entirety.';
$authtext4 = 'I hereby expressly authorize and appoint Initiative Legal Group, APC as my representative to act on my behalf and in my place to obtain my personnel file and time, wage and payroll records by any and all means necessary and available.';
$authsignline = '__________________________________              ________________';
$authsigntext = 'SIGN YOUR FULL NAME                                               Date';
$pdf->Ln();
$pdf->Ln();
$pdf->SetFont('Times','B',12);
$pdf->MultiCell(0,5,$authtitle,'','C');
$pdf->Ln(1);
$pdf->MultiCell(0,5,$authtitle2,'','C');
$pdf->Ln(3);
$pdf->MultiCell(0,5,$authline,'','C');
$pdf->Ln();
$pdf->SetFont('Times','',12);
$pdf->Cell(0,5,$towhom);
$pdf->Ln(10);
$pdf->SetFont('Times','',12);
$pdf->MultiCell(0,5,$authintro);
$pdf->Ln();
$pdf->SetFont('Times','',12);
$pdf->MultiCell(0,5,$authtext);
$pdf->Ln();
$pdf->MultiCell(0,5,$authtext2);
$pdf->Ln();
$pdf->Cell(0,5,$authtext3);
$pdf->Ln(10);
$pdf->MultiCell(0,5,$authtext4);
$pdf->Ln(10);
$pdf->Cell(0,5,$authsignline);
$pdf->Ln(9);
$pdf->Cell(0,5,$authsigntext);
$pdf->SetFont('Arial','',10);
$code= "$uniqueid";
$pdf->Code128(130,260,$code,70,10);
$pdf->SetXY(130,270);
$pdf->Write(5,''.$code.'');

$pdf->AddPage();
$pdf->Image('logo.png',62,15,'',8,0,'','');
#$pdf->Image('logo.png',);
#$pdf->Image('logo.png',62,13,8,0,'','');
$pdf->Ln();
#$pdf->SetFont('helvetica','B',12);
#$pdf->MultiCell(0,5,$hellocompany,'','C');
$pdf->Ln(15);
$clientname = "$FirstName" . " $LastName";
$authtitle = 'AUTHORIZATION FOR SETTLEMENT, DISMISSAL AND SIMILAR';
$authtitle2 = 'ACTIONS BY ATTORNEY';
$authline = '_________________________________________';
$towhom = 'To Whom It May Concern:';
$authintro = 'I, ' . "$clientname" . ' ("Client"),';
$authtext = ' give my Attorneys, Initiative Legal Group APC, authority to settle and release my claims for unpaid overtime, missed meal and rest breaks, unpaid minimum wages, unlawful wage deductions, unpaid commissions, failure to provide seating during a work shift, wages not timely paid upon termination, non-compliant wage statements, and derivative claims under California Business & Professions Code sections 17200 et seq. (the "Claims") if the total offer will yield Client at least $200 total, after the deduction of legal fees or costs.';
$authtext2 = 'I/Client authorize and agree that Attorneys have the choice of reaching a settlement, if any, with Macy\'s, Inc. either by individual settlement or through a multi-party/group settlement or a class action settlement.  If judgment, award or settlement is obtained in my matter, I/Client authorize Attorneys to execute any documents on my behalf to effectuate the settlement and any release and dismissal, deposit any proceeds into the Attorneys\' client trust account, and to distribute the funds as agreed.';
$authtext3 = '          b) All of my time, wage and payroll records, including my wage stubs in their entirety.';
$authtext4 = 'I hereby expressly authorize and appoint Initiative Legal Group, APC as my representative to act on my behalf and in my place to obtain my personnel file and time, wage and payroll records by any and all means necessary and available.';
$authsignline = '__________________________________              ________________';
$authsigntext = 'SIGN YOUR FULL NAME                                               Date';
$disclaimer = 'Disclaimer: Initiative Legal Group APC does not make any promises or guarantees as to any specific outcome of any case.';
#$pdf->Ln();
#$pdf->Ln();
$pdf->SetFont('Times','B',12);
$pdf->MultiCell(0,5,$authtitle,'','C');
$pdf->Ln(1);
$pdf->MultiCell(0,5,$authtitle2,'','C');
$pdf->Ln(3);
$pdf->MultiCell(0,5,$authline,'','C');
$pdf->Ln();
//$pdf->SetFont('Times','',12);
//$pdf->Cell(0,5,$towhom);
//$pdf->Ln(10);
//$pdf->SetFont('Times','',12);
//$pdf->MultiCell(0,5,$authintro);
//$pdf->Ln();
$pdf->SetFont('Times','',12);
$pdf->MultiCell(0,10,$authintro.''.$authtext);
$pdf->Ln();
$pdf->MultiCell(0,10,$authtext2);
#$pdf->MultiCell();
$pdf->Ln();
$pdf->Ln();

//$pdf->Cell(0,5,$authtext3);
//$pdf->Ln(10);
//$pdf->MultiCell(0,5,$authtext4);
//$pdf->Ln(10);
$pdf->Cell(0,5,$authsignline);
$pdf->Ln(9);
$pdf->Cell(0,5,$authsigntext);
$pdf->Ln();
$pdf->Ln();
$pdf->Ln();
$pdf->SetFont('Times','BI',12);
$pdf->MultiCell(0,5,$disclaimer,'','L');

$pdf->SetFont('Arial','',10);
$code= "$uniqueid";
$pdf->Code128(130,260,$code,70,10);
$pdf->SetXY(130,270);
$pdf->Write(5,''.$code.'');


$dir='/inetpub/wwwroot/';
$filename = "$LastName, " .  "$FirstName" . " - $uniqueid"; 
$filename2 = "$LastName, " .  "$FirstName" . " - Authorizations - $uniqueid"; 
$ext = ".pdf";
$pdf->Output("/inetpub/wwwroot/$filename2$ext","F"); //pushes file to server for temp storage
$pdf->Output("/inetpub/wwwroot/Retainerstmp/$filename2$ext","F"); //pushes file to server for temp storage
//pdf create end
//FTP
$ftp_server = '10.129.3.21';
$ftp_user_name = 'sqlsrv';
$ftp_user_pass = 'password';
$dir0 = '/' . "$brandname" . '/';
$dir1 = "$dir0" . "$filename";
$dir2 = "$dir1" . '/';
$dir3 = "$dir1" . '/';
$file = "$filename" . "$ext";
$file2 = "$filename2" . "$ext";
$conn_id = ftp_connect($ftp_server);
$login_result = ftp_login($conn_id, $ftp_user_name, $ftp_user_pass);
if (is_dir('ftp://sqlsrv:password@10.129.3.21/'.$dir3.''))
{
    
}
else
{
    ftp_mkdir($conn_id, $dir3);
}

ftp_chdir($conn_id, $dir3);
ftp_put($conn_id, $file2, $file2, FTP_BINARY);
ftp_close($conn_id);
unlink($file2); 
//ftp end

//docusign start


//require ("include/ianSession.php"); 
//require ("api/ianCredential.php");
//require ("api/APIService.php");
//require ("include/utils.php");
//	$_SESSION["UserID"] = "ihutchings@initiativelegal.com";
//	$_SESSION["AccountID"] = "873db901-09a0-460f-933a-e0069b414d3f";
//        $_SESSION["Password"] = "siec9oanoapoeqiA";
//        $_SESSION["IntegratorsKey"] = "INIT-ec3b5acd-ad64-496b-b821-2b89ae424e82";

require ("include/prod/ianSession.php"); 
require ("api/prod/ianCredential.php");
require ("api/prod/APIService.php");
require ("include/prod/utils.php");
//prod UserID
$_SESSION["UserID"] = "4dbf6087-64d2-4584-bf04-698ce5bf24d7";
//demo UserID
#		$_SESSION["UserID"] = "ihutchings@preferredlegalsupport.com";
//this one is the production accountid		
$_SESSION["AccountID"] = "7ac3ef7c-e311-400e-a932-31f225a2e747";
//this one is the demo accountid
#		$_SESSION["AccountID"] = "c468460b-4d8f-4fd6-980c-0974de9c815a";
		$_SESSION["Password"] = "siec9oanoapoeqiA";

        $_SESSION["IntegratorsKey"] = "INIT-ec3b5acd-ad64-496b-b821-2b89ae424e82";
//========================================================================
// globals
//========================================================================
$_oneSigner = true; // Do we want One Signer (=true) or Two (=false)
$_showTwoSignerMessage = false; // Display (or not display) a message before Signer One has signed (only for Two Signer mode)
$_showTransitionMessage = false; // Display (or not display) a message after Signer One has signed (only for Two Signer mode)
//========================================================================
// Functions
//========================================================================

/**
 * Creates an embedded signing experience.
 */
$chewypdf = './Retainerstmp/'."$filename2".'.pdf';
$pdfname = "$filename2";
$chewonthis = "PDFBytes = file_get_contents($chewypdf)";
function createAndSend($pdffilename,$subject,$name,$uniqueid,$brandid,$brand,$tenantid,$FirstName,$LastName,$email,$RecipientName2,$RecipientEmail2) {
    global $_oneSigner;
    $status = "";
    
    // Construct basic envelope
    $env = new Envelope();
    $env->Subject = $subject;
    $env->EmailBlurb = "This envelope demonstrates embedded signing";
    $env->AccountId = $_SESSION['AccountID'];
    $env->Recipients = constructRecipients($FirstName,$LastName,$email,$RecipientName2,$RecipientEmail2);
    
    $doc = new Document();
    $doc->PDFBytes = file_get_contents($pdffilename);
	$doc->Name = $name;

    $doc->ID = "1";
    $doc->FileExtension = "pdf";
    $env->Documents = array($doc);
    
    $env->Tabs = addTabs(count($env->Recipients));
    
    $api = getAPI();
    try {
        $csParams = new CreateAndSendEnvelope();
        $csParams->Envelope = $env;
        $status = $api->CreateAndSendEnvelope($csParams)->CreateAndSendEnvelopeResult;
        addEnvelopeID($status->EnvelopeID);
        getToken($status, 1, $uniqueid, $brandid, $brand, $tenantid);
    } catch (SoapFault $e) {
        $_SESSION['errorMessage'] = $e;
        header("Location: errorpretty.php");
    }
}

/**
 * Construct recipients
 * 
 * @param boolean $oneSigner
 * 	true - create one recipient
 * 	false = create two recipient
 * 
 * @return Recipient[]
 */


function constructRecipients($FirstName,$LastName,$email,$RecipientName2,$RecipientEmail2) 
{
    $recipients = array();
    
    $count = count($FirstName);
    for ($i = 1; $i <= $count; $i++) {
    	
    		// Must contain all POST parameters
    		if(empty($FirstName) ||
    			 empty($email)){
    			 	continue;
    		}
    	
        $r1 = new Recipient();
        
        $r1->UserName = $FirstName. ' ' .$LastName;
        $r1->Email = $email;
        $r1->RequireIDLookup = false;
        $r1->ID = 1;
        $r1->Type = RecipientTypeCode::Signer;
        $r1->RoutingOrder = 1;    
        if(!isset($_POST['RecipientInviteToggle'][1])){
        	$r1->CaptiveInfo = new RecipientCaptiveInfo();
        	$r1->CaptiveInfo->ClientUserId = 1;
        }
        
        array_push($recipients, $r1);
		
        $r2 = new Recipient();
        
        $r2->UserName = $RecipientName2;
        $r2->Email = $RecipientEmail2;
        $r2->RequireIDLookup = false;
        $r2->ID = 2;
        $r2->Type = RecipientTypeCode::CarbonCopy;
        $r2->RoutingOrder = 2;
        
		//ian)-> comment next three lines to set 2nd recipient to recieve email when recipient 1 is done signing
#        if(!isset($_POST['RecipientInviteToggle'][$i])){
#        	$r1->CaptiveInfo = new RecipientCaptiveInfo();
#        	$r1->CaptiveInfo->ClientUserId = $i;
#       }
        
        array_push($recipients, $r2);

    }
    
    if(empty($recipients)){
	    $_SESSION['errorMessage'] = "You must include at least 1 Recipient";
	    header("Location: errorpretty.php");
	    exit;
    }
    
    return $recipients;
}

function addTabs($count) {
    $tabs[] = new Tab();
    
//first page initials at bottom right
	$sign2 = new Tab();
    $sign2->Type = TabTypeCode::SignHere;
    $sign2->DocumentID = "1";
    $sign2->PageNumber = "1";
    $sign2->RecipientID = "1";
    $sign2->XPosition = "29";
    $sign2->YPosition = "345";
    array_push($tabs, $sign2);
    
	$sign3 = new Tab();
	$sign3->Type = TabTypeCode::SignHere;
	$sign3->DocumentID = "1";
	$sign3->PageNumber = "2";
	$sign3->RecipientID = "1";
	$sign3->XPosition = "29";
	$sign3->YPosition = "530";
	array_push($tabs, $sign3);
    
	$date2 = new Tab();
    $date2->Type = TabTypeCode::DateSigned;
    $date2->DocumentID = "1";
    $date2->PageNumber = "1";
    $date2->RecipientID = "1";
    $date2->XPosition = "300";
    $date2->YPosition = "393";
    array_push($tabs, $date2);
	
	$date3 = new Tab();
	$date3->Type = TabTypeCode::DateSigned;
	$date3->DocumentID = "1";
	$date3->PageNumber = "2";
	$date3->RecipientID = "1";
	$date3->XPosition = "300";
	$date3->YPosition = "578";
	array_push($tabs, $date3);    
 
    // eliminate 0th element
    array_shift($tabs);
    
    return $tabs;
}
function getToken($status, $clientID, $uniqueid, $brandid, $brand, $tenantid) {
    global $_oneSigner;
    $token = null;
    $_SESSION['embedToken'];
       
    // get recipient token
    $assertion = new RequestRecipientTokenAuthenticationAssertion();
    $assertion->AssertionID = guid();
    $assertion->AuthenticationInstant = todayXsdDate();
    $assertion->AuthenticationMethod = RequestRecipientTokenAuthenticationAssertionAuthenticationMethod::Password;
    $assertion->SecurityDomain = "DocuSign2011Q1Sample";
    
    // Get Recipient fro ClientID
    $recipient = false;
		foreach($status->RecipientStatuses->RecipientStatus as $rs){
			if($rs->ClientUserId == $clientID){
    		$recipient = $rs;
    	}
    }
    
    if($recipient == false){
	    $_SESSION['errorMessage'] = "Unable to find Recipient";
	    header("Location: error.php");
    }
    
    $urls = new RequestRecipientTokenClientURLs();
    $urlbase = getCallbackURL("pop.html") . "?source=Embedded";
    
    $urls->OnAccessCodeFailed = $urlbase . "&event=AccessCodeFailed&uname=" . $recipient->UserName;
    $urls->OnCancel = "https://DFWMS01.initiativelegal.com/AfterAuth1.php";
    $urls->OnDecline = "https://DFWMS01.initiativelegal.com/AfterAuth1.php";
    $urls->OnException = "https://DFWMS01.initiativelegal.com/AfterAuth1.php";
    $urls->OnFaxPending = 'https://DFWMS01.initiativelegal.com/AfterAuth1.php?uniqueid=' . "$uniqueid".'&statuslevel=Faxpending';
    $urls->OnIdCheckFailed = "https://DFWMS01.initiativelegal.com/thanks.php";
    $urls->OnSessionTimeout = "https://DFWMS01.initiativelegal.com/thanks.php";
    $urls->OnTTLExpired = "https://DFWMS01.initiativelegal.com/thanks.php";
    $urls->OnViewingComplete = 'https://DFWMS01.initiativelegal.com/AfterAuth1.php?uniqueid=' . "$uniqueid".'&statuslevel=Faxpending';
    if ($_oneSigner) {
        $urls->OnSigningComplete = 'https://DFWMS01.initiativelegal.com/AfterAuth1.php?uniqueid=' . "$uniqueid".'&statuslevel=Signed';
    }
    else {
        $urls->OnSigningComplete = 'https://DFWMS01.initiativelegal.com/AfterAuth1.php?uniqueid=' . "$uniqueid".'&statuslevel=Signed';
    }
    
    $api = getAPI();
    $rrtParams = new RequestRecipientToken();
    $rrtParams->AuthenticationAssertion = $assertion;
    $rrtParams->ClientURLs = $urls;
    $rrtParams->ClientUserID = $recipient->ClientUserId;
    $rrtParams->Email = $recipient->Email;
    $rrtParams->EnvelopeID = $status->EnvelopeID;
    $rrtParams->Username = $recipient->UserName;
    
    try {
        $token = $api->RequestRecipientToken($rrtParams)->RequestRecipientTokenResult;
    } catch (SoapFault $e) {
        $_SESSION['errorMessage'] = $e;
        header("Location: error.php");
    }
    ##ian --)> uncomment this line to allow for SOAP trace, also uncomment the last couple lines of the file that refer to piping arrays into xml
     #print_r($api);
     $_SESSION["embedToken"] = $token;
}
function getStatus($envelopeID) {
    $status = null;
    
    $api = getAPI();
    
    $rsParams = new RequestStatus();
    $rsParams->EnvelopeID = $envelopeID;
    
    try {
        $status = $api->RequestStatus($rsParams)->RequestStatusResult;
    } catch (SoapFault $e) {
        $_SESSION['errorMessage'] = $e;
        header("Location: errorpretty.php");
    }
    
    return $status;
}

//========================================================================
// Main
//========================================================================

loginCheck();

if ($_SERVER['REQUEST_METHOD'] == 'GET') 	
#if ($_SERVER['REQUEST_METHOD'] == 'POST') 
{

    $_oneSigner = isset($_POST['OneSigner']);
	$_oneSigner = isset($_REQUEST['OneSigner']);
    createAndSend($chewypdf,$pdfname,$pdfname,$uniqueid,$brandid,$brand,$tenantid,$FirstName,$LastName,$email,$RecipientName2,$RecipientEmail2);
		if(!$_oneSigner)
		{
			$_showTwoSignerMessage = true;
		}

}
if(isset($_SESSION['embedToken']) && !empty($_SESSION['embedToken']))
{





echo '<body>';


echo '<div id="main">';
echo '<div id="message">';
echo '<h4>CONFIDENTIAL ATTORNEY-CLIENT PRIVILEGED COMMUNICATION</h4>';
echo '<h3><span class="underline">STEP ONE:</span> Sign Two Authorization Forms.</h3>';
echo '<ul>';
echo '<li><p>There are two forms below you will be asked to sign. The first is an Authorization for Release of Personnel File and Wage Records form. By signing this Authorization form, you will help us request from Macy\'s the release of your employment records to our law firm, which may be helpful to support your potential claims.</p></li>';
echo '<li><p>The second is an Authorization for Settlement form. By signing this Authorization form, you will allow our law firm to settle and release your potential wage and hour claims against Macy\'s on your behalf for at least $200 total, after the deduction of legal fees or costs. </p></li>';
echo '<li><p>Please fill out the two Authorization forms by completing these <strong>three</strong> items:</p></li>';
echo '</ul>';

echo '<ol>';
echo '<li><p>Carefully review the Authorization forms and verify the spelling of your full name at the top of each document.</p></li>';
echo '<li><p>When prompted, use your computer mouse to draw your electronic signature.  Don\'t worry if your signature does not look like your regular signature.  All that is required is that you make an original mark on this document. Signature instructions will be included in the document.</p></li>';
echo '<li><p>Please click on the "confirm signing" button after you have verified the spelling of your name and electronically signed the forms and you will proceed to the next step of the process.</p></li>';

echo '</ol>';
echo '<p class="disclaimer">Disclaimer: Initiative Legal Group APC does not make any promises or guarantees as to any specific outcome of any case.</p>';

echo "<table align='center' width='1100px' border='0' cellpadding='0' cellspacing='0'>";
		echo "<tr>";
		echo "<td  height='2600px'   align='center'>";
		echo "<iframe  align='middle' marginheight='5%' width='99%' height='98%' src='";
		echo $_SESSION['embedToken'] . "&id='focusstealer' name='focusstealer' frameborder='0' ";
		echo 'onload="reloadPage()"';
		echo "></iframe>";
		
		echo "</td>";
		echo "</tr>";
		echo "</table>";


echo "</div>";

echo '</div>';
echo '</div>';


echo '</body>';

}
	
}//wrap end--If they've completed the the auth form already they wont see the above
?>
<?PHP 

if (isset($authformreceived)) if (!isset($longformcompleteonline))
{//wrap this in conditional -- only if never completed the long form

echo '<script type="text/javascript">';
echo 'function reloadPage()';
echo '{';
echo 'window.top.location.replace("https://macyslawsuit.com/longform/?uniqueid='.$uniqueid.'");';
echo '}';
echo '</script>';


echo '<body onload="reloadPage()">';
}//wrap end--If they've completed the long form already they wont see the above
if (isset($authformreceived)) if (isset($longformcompleteonline))
{
	require("AfterLongForm.php");
}
?>

<!--
[__last_response_headers] => <?xml version=”1.0 encoding=”UTF-8”?>
[__lastRequest] => <?xml version=”1.0 encoding=”UTF-8”?>-->

</div>
</html>